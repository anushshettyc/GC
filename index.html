Conversation opened. 4 messages. All messages read.

Skip to content
Using Gmail with screen readers
in:sent 
1 of 803
(no subject)

Anush Shetty
Tue, Sep 30, 3:04 PM (2 days ago)
<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Bedrock Voice Assis

Anush Shetty
Wed, Oct 1, 9:49 AM (1 day ago)
https://meet.google.com/yvd-uirj-dnu

Anush Shetty
AttachmentsWed, Oct 1, 1:56 PM (1 day ago)
On Wed, Oct 1, 2025 at 9:49 AM Anush Shetty <anushpb@gmail.com> wrote: https://meet.google.com/yvd-uirj-dnu On Tue, Sep 30, 2025 at 3:04 PM Anush Shetty <anushp

Anush Shetty <anushpb@gmail.com>
Attachments
12:34 PM (5 hours ago)
to senthil

Replace the lamda URL with yours . I am using function  URL  from with public access for  this.
 One attachment
  •  Scanned by Gmail
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDFC BANK - Banking Solutions for You</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
        }

        /* Header */
        header {
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 100;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 5%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #d32f2f;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #d32f2f;
        }

        .login-btn {
            background: #d32f2f;
            color: white;
            padding: 0.6rem 1.5rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 500;
            transition: background 0.3s;
        }

        .login-btn:hover {
            background: #b71c1c;
        }

        /* Hero Section */
        .hero {
            margin-top: 70px;
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 5rem 5%;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .cta-btn {
            background: white;
            color: #d32f2f;
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .cta-btn:hover {
            transform: scale(1.05);
        }

        /* Services Section */
        .services {
            padding: 4rem 5%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .services h2 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: #333;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }

        .service-card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 25px rgba(0,0,0,0.15);
        }

        .service-card h3 {
            color: #d32f2f;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .service-card p {
            color: #666;
            line-height: 1.6;
        }

        /* Footer */
        footer {
            background: #222;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        /* Voice Assistant Button */
        .voice-assistant-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            cursor: pointer;
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            z-index: 1000;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .voice-assistant-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.6);
        }

        .voice-assistant-btn.listening {
            animation: pulse 1.5s infinite;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 6px 25px rgba(239, 68, 68, 0.5);
            }
            50% {
                transform: scale(1.15);
                box-shadow: 0 8px 35px rgba(239, 68, 68, 0.7);
            }
        }

        /* Voice Assistant Modal */
        .voice-modal {
            display: none;
            position: fixed;
            bottom: 120px;
            right: 30px;
            width: 380px;
            height: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            flex-direction: column;
            overflow: hidden;
        }

        .voice-modal.active {
            display: flex;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .modal-header h1 {
            font-size: 18px;
            margin-bottom: 3px;
        }

        .modal-header p {
            font-size: 12px;
            opacity: 0.9;
        }

        .close-modal {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            font-weight: 300;
            line-height: 1;
        }

        .end-conversation-btn {
            position: absolute;
            top: 10px;
            left: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }

        .end-conversation-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 12px;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            text-align: right;
        }

        .message-bubble {
            display: inline-block;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
            font-size: 14px;
        }

        .message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message.agent .message-bubble {
            background: white;
            color: #333;
            border: 1px solid #e0e0e0;
        }

        .timestamp {
            font-size: 10px;
            opacity: 0.6;
            margin-top: 4px;
        }

        .controls {
            padding: 15px;
            background: white;
            border-top: 1px solid #e0e0e0;
        }

        .status {
            text-align: center;
            padding: 10px;
            font-size: 13px;
            color: #6b7280;
            min-height: 40px;
            font-weight: 500;
        }

        .status.listening {
            color: #ef4444;
            font-weight: 600;
        }

        .status.processing {
            color: #667eea;
            font-weight: 600;
        }

        .session-info {
            background: #f0f4ff;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 11px;
            color: #667eea;
            margin-top: 10px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .voice-modal {
                width: calc(100vw - 20px);
                right: 10px;
                bottom: 100px;
                height: 450px;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .nav-links {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo">IDFC BANK</div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#services">Services</a></li>
                <li><a href="#products">Products</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <a href="#" class="login-btn">Login</a>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <h1>Welcome to IDFC BANK</h1>
        <p>Your Trusted Banking Partner for All Financial Solutions</p>
        <button class="cta-btn">Open Account Today</button>
    </section>

    <!-- Services Section -->
    <section class="services" id="services">
        <h2>Our Services</h2>
        <div class="service-grid">
            <div class="service-card">
                <h3>💳 Credit Cards</h3>
                <p>Exclusive credit cards with amazing rewards, cashback, and benefits tailored for your lifestyle.</p>
            </div>
            <div class="service-card">
                <h3>🏠 Home Loans</h3>
                <p>Competitive interest rates and flexible repayment options to help you own your dream home.</p>
            </div>
            <div class="service-card">
                <h3>💼 Personal Loans</h3>
                <p>Quick approval and instant disbursal for all your personal financial needs.</p>
            </div>
            <div class="service-card">
                <h3>💰 Savings Account</h3>
                <p>High interest rates, zero balance accounts, and digital banking at your fingertips.</p>
            </div>
            <div class="service-card">
                <h3>📈 Investment Options</h3>
                <p>Mutual funds, fixed deposits, and wealth management services for growing your money.</p>
            </div>
            <div class="service-card">
                <h3>🌐 Digital Banking</h3>
                <p>24/7 online banking, mobile app, and instant transactions for your convenience.</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 IDFC BANK. All rights reserved. | Banking with Trust</p>
    </footer>

    <!-- Voice Assistant Button -->
    <button class="voice-assistant-btn" id="voiceBtn">🎙️</button>

    <!-- Voice Assistant Modal -->
    <div class="voice-modal" id="voiceModal">
        <div class="modal-header">
            <button class="end-conversation-btn" id="endConversation">End Call</button>
            <button class="close-modal" id="closeModal">×</button>
            <h1>🎙️ Voice Assistant</h1>
            <p>IDFC First Bank - Powered by AI</p>
        </div>

        <div class="chat-container" id="chatContainer">
            <div class="message agent">
                <div class="message-bubble">
                    Hello! I'm your IDFC First Bank assistant. How can I help you today?
                </div>
                <div class="timestamp">Just now</div>
            </div>
        </div>

        <div class="controls">
            <div class="status" id="status">Listening... Speak now</div>
            <div class="session-info" id="sessionInfo">Session not started</div>
        </div>
    </div>

    <script>
        // Session management
        let conversationSessionId = sessionStorage.getItem('bedrockSessionId');
        
        if (!conversationSessionId) {
            conversationSessionId = `session-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
            sessionStorage.setItem('bedrockSessionId', conversationSessionId);
        }
        
        updateSessionInfo();

        // Voice recognition setup
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'en-US';
        recognition.continuous = false;
        recognition.interimResults = false;

        let isListening = false;
        let modalOpen = false;
        let autoListenEnabled = false;

        // Modal controls
        const voiceBtn = document.getElementById('voiceBtn');
        const voiceModal = document.getElementById('voiceModal');
        const closeModal = document.getElementById('closeModal');
        const endConversation = document.getElementById('endConversation');

        voiceBtn.addEventListener('click', () => {
            voiceModal.classList.add('active');
            modalOpen = true;
            autoListenEnabled = true;
            // Automatically start listening when modal opens
            setTimeout(() => {
                try {
                    recognition.start();
                } catch (e) {
                    console.log('Recognition start error:', e);
                }
            }, 500);
        });

        closeModal.addEventListener('click', () => {
            stopAssistant();
        });

        endConversation.addEventListener('click', () => {
            if (confirm('Are you sure you want to end this conversation?')) {
                stopAssistant();
                // Clear conversation history
                const chatContainer = document.getElementById('chatContainer');
                chatContainer.innerHTML = `
                    <div class="message agent">
                        <div class="message-bubble">
                            Hello! I'm your IDFC First Bank assistant. How can I help you today?
                        </div>
                        <div class="timestamp">Just now</div>
                    </div>
                `;
                // Reset session
                sessionStorage.removeItem('bedrockSessionId');
                conversationSessionId = `session-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                sessionStorage.setItem('bedrockSessionId', conversationSessionId);
                updateSessionInfo();
            }
        });

        function stopAssistant() {
            voiceModal.classList.remove('active');
            modalOpen = false;
            autoListenEnabled = false;
            if (isListening) {
                recognition.stop();
            }
            window.speechSynthesis.cancel();
            voiceBtn.classList.remove('listening');
            updateStatus('Click to start', '');
        }

        recognition.onstart = () => {
            isListening = true;
            updateStatus('Listening... Speak now', 'listening');
            voiceBtn.classList.add('listening');
        };

        recognition.onend = () => {
            isListening = false;
            voiceBtn.classList.remove('listening');
            console.log('Recognition ended');
        };

        recognition.onresult = async (event) => {
            const transcript = event.results[0][0].transcript;
            console.log('Transcript received:', transcript);
            
            // Stop recognition to prevent abort errors
            try {
                recognition.stop();
            } catch (e) {
                console.log('Recognition already stopped');
            }
            
            addMessage(transcript, 'user');
            updateStatus('Processing your request...', 'processing');
            
            try {
                const response = await sendToLambda(transcript);
                console.log('Got response from Lambda:', response);
                addMessage(response, 'agent');
                
                // Speak the response and auto-listen after
                await speakResponse(response);
                
            } catch (error) {
                console.error('Error in onresult:', error);
                
                let errorMessage = 'Sorry, there was an error processing your request.';
                
                // Provide more specific error messages
                if (error.message.includes('500')) {
                    errorMessage = 'Sorry, the AI service is having issues. Please try again.';
                } else if (error.message.includes('Network')) {
                    errorMessage = 'Sorry, network connection issue. Please check your internet.';
                } else if (error.message.includes('No reply')) {
                    errorMessage = 'Sorry, I didn\'t receive a proper response. Please try again.';
                }
                
                addMessage(errorMessage, 'agent');
                
                // Speak the error and continue listening
                await speakResponse(errorMessage);
            }
        };

        recognition.onerror = (event) => {
            console.error('Speech recognition error:', event.error);
            
            isListening = false;
            voiceBtn.classList.remove('listening');
            
            // Handle different error types
            if (event.error === 'no-speech') {
                updateStatus('No speech detected. Listening again...', '');
                // Restart immediately for no-speech
                if (modalOpen && autoListenEnabled) {
                    setTimeout(() => {
                        try {
                            recognition.start();
                        } catch (e) {
                            console.log('Recognition already started');
                        }
                    }, 1000);
                }
            } else if (event.error === 'aborted') {
                console.log('Speech recognition aborted - this is normal during processing');
                // Don't show error for aborted, it's expected during transitions
                return;
            } else if (event.error === 'audio-capture') {
                updateStatus('Microphone error. Please check permissions.', '');
                alert('Please allow microphone access to use voice assistant.');
            } else if (event.error === 'not-allowed') {
                updateStatus('Microphone access denied.', '');
                alert('Please allow microphone access in your browser settings.');
            } else {
                updateStatus(`Error: ${event.error}. Retrying...`, '');
                // Retry for other errors
                if (modalOpen && autoListenEnabled) {
                    setTimeout(() => {
                        try {
                            recognition.start();
                        } catch (e) {
                            console.log('Recognition already started');
                        }
                    }, 2000);
                }
            }
        };

        async function sendToLambda(text) {
            console.log('Sending to Lambda:', text);
            console.log('Session ID:', conversationSessionId);
            
            try {
                const requestBody = {
                    inputText: text,
                    sessionId: conversationSessionId
                };
                
                console.log('Request body:', JSON.stringify(requestBody));
                
                const response = await fetch('https://bne36y45fhsixvq6mvnp2ynrqu0aiywl.lambda-url.ap-northeast-1.on.aws/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('Lambda error response:', errorText);
                    throw new Error(`HTTP error! status: ${response.status}, body: ${errorText}`);
                }

                const data = await response.json();
                console.log('Lambda response data:', data);
                
                if (!data.reply) {
                    console.error('No reply in response:', data);
                    throw new Error('No reply field in response');
                }
                
                return data.reply;
            } catch (error) {
                console.error('sendToLambda error:', error);
                throw error;
            }
        }

        function addMessage(text, type) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const time = new Date().toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            messageDiv.innerHTML = `
                <div class="message-bubble">${text}</div>
                <div class="timestamp">${time}</div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function updateStatus(text, className = '') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = text;
            statusDiv.className = `status ${className}`;
        }

        function updateSessionInfo() {
            const sessionInfo = document.getElementById('sessionInfo');
            const shortId = conversationSessionId.substring(0, 20) + '...';
            sessionInfo.textContent = `Session: ${shortId}`;
        }

        function speakResponse(text) {
            return new Promise((resolve) => {
                if ('speechSynthesis' in window) {
                    // Cancel any ongoing speech first
                    window.speechSynthesis.cancel();
                    
                    // Small delay to ensure cancellation is complete
                    setTimeout(() => {
                        const utterance = new SpeechSynthesisUtterance(text);
                        utterance.rate = 1.0;
                        utterance.pitch = 1.0;
                        utterance.volume = 1.0;
                        utterance.lang = 'en-US';
                        
                        utterance.onstart = () => {
                            console.log('Started speaking:', text);
                            updateStatus('Speaking...', 'processing');
                        };
                        
                        utterance.onend = () => {
                            console.log('Finished speaking');
                            updateStatus('Listening... Speak now', 'listening');
                            
                            // Automatically start listening again after speaking
                            if (modalOpen && autoListenEnabled) {
                                setTimeout(() => {
                                    try {
                                        console.log('Auto-starting recognition after speech');
                                        recognition.start();
                                    } catch (e) {
                                        console.log('Recognition start error after speech:', e);
                                    }
                                }, 800);
                            }
                            resolve();
                        };
                        
                        utterance.onerror = (error) => {
                            console.error('Speech synthesis error:', error);
                            updateStatus('Speech error. Listening...', 'listening');
                            // Still resolve and continue
                            if (modalOpen && autoListenEnabled) {
                                setTimeout(() => {
                                    try {
                                        recognition.start();
                                    } catch (e) {
                                        console.log('Recognition start error after speech error:', e);
                                    }
                                }, 800);
                            }
                            resolve();
                        };
                        
                        console.log('Speaking text:', text);
                        window.speechSynthesis.speak(utterance);
                    }, 200);
                } else {
                    console.log('Speech synthesis not available');
                    // If speech synthesis not available, just continue listening
                    if (modalOpen && autoListenEnabled) {
                        setTimeout(() => {
                            try {
                                recognition.start();
                            } catch (e) {
                                console.log('Recognition start error:', e);
                            }
                        }, 500);
                    }
                    resolve();
                }
            });
        }

        // Check browser support
        if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
            updateStatus('Speech recognition not supported in this browser');
            voiceBtn.disabled = true;
            voiceBtn.style.opacity = '0.5';
            voiceBtn.style.cursor = 'not-allowed';
        }
    </script>
</body>
</html>
index (1).html
Displaying index (1).html.
